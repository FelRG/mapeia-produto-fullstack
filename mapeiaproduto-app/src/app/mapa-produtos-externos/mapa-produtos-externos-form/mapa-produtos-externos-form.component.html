<br>
<ol class="breadcrumb mb-4">
  <li class="breadcrumb-item active">Mapa dos Produtos</li>
</ol>

<div class="container pb-4">

  <!-- <label for="buscaProduto" class="form-label">Pesquise por um nome de produto</label> -->
  <!-- Campo de Busca -->
  <!-- <div class="d-flex mb-4">
    <input type="text" class="form-control rounded-pill border border-dark me-2" [(ngModel)]="nomeProduto"
      placeholder="Digite o nome de um produto..." />
    <button class="btn btn-outline-dark rounded-pill px-4 btn-search" type="button" (click)="buscarProduto()">
      <i class="bi bi-search"></i>
    </button>
  </div> -->

  <div class="mb-3 position-relative" #autocompleteProdutoContainer>
    <label for="produto" class="form-label">Pesquise por um nome de produto</label>

    <!-- Linha horizontal: chip ou input + botão de busca -->
    <div class="d-flex align-items-center gap-2">

      <!-- Chip (aparece quando produto está selecionado) -->
      <div *ngIf="produtoSelecionado" class="flex-grow-1">
        <div class="chip bg-light border border-dark d-inline-flex align-items-center w-100 px-3 py-2 rounded-pill">
          {{ produtoSelecionado.nomeProduto }}
          <button type="button" class="btn-close ms-auto" aria-label="Remover"
            (click)="removerProdutoSelecionado()"></button>
        </div>
      </div>

      <!-- Input (aparece quando NÃO há produto selecionado) -->
      <input *ngIf="!produtoSelecionado" id="produto" name="produtoInput" type="text"
        class="form-control rounded-pill px-3 border border-dark flex-grow-1" [(ngModel)]="produtoInput"
        (input)="buscarProdutos(produtoInput)" (focus)="aoFocarCampoProduto()"
        placeholder="Digite o nome do produto..." />

      <!-- Botão de lupa (sempre visível) -->
      <button class="btn btn-outline-dark rounded-pill px-4 btn-search" type="button" (click)="buscarProduto()">
        <i class="bi bi-search"></i>
      </button>
    </div>

    <!-- Lista de sugestões -->
    <ul class="list-group position-absolute w-100 z-3"
      *ngIf="mostrarSugestoesProduto && produtosFiltrados.length > 0 && !produtoSelecionado">
      <li class="list-group-item" *ngFor="let prod of produtosFiltrados" (click)="selecionarProduto(prod)">
        {{ prod.nomeProduto }}
      </li>
    </ul>
  </div>




  <!-- Mapa abaixo -->
  <div #mapa style="height: 500px; width: 100%; border-radius: 12px; border: 1px solid #ccc;"></div>


</div>